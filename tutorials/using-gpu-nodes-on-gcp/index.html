<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">Using GPU Nodes on GCP | Parallel Works</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/tutorials/using-gpu-nodes-on-gcp"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Using GPU Nodes on GCP | Parallel Works"><meta data-react-helmet="true" name="description" content="Introduction to using attached GPU node types with Slurm and Jupyter"><meta data-react-helmet="true" property="og:description" content="Introduction to using attached GPU node types with Slurm and Jupyter"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/tutorials/using-gpu-nodes-on-gcp"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/tutorials/using-gpu-nodes-on-gcp" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/tutorials/using-gpu-nodes-on-gcp" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c469beb1.css">
<link rel="preload" href="/assets/js/runtime~main.334342b3.js" as="script">
<link rel="preload" href="/assets/js/main.8b38f249.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-notext.svg" alt="Parallel Works Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo-notext.svg" alt="Parallel Works Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Parallel Works</b></a><a class="navbar__item navbar__link navbar__link--active" href="/">Parallel Works Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/parallelworks/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/navigating-the-platform/getting-started/">Navigating the Platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/about-the-platform/navigating_key_resources_functions">About the Platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/build-and-edit-workflows/navigating_key_workflow_functions">Build and Edit Workflows</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/developers-guide/swift_scripting_language">Developer&#x27;s Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/tutorials/helyx-os_cloud_connector/">Tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/tutorials/helyx-os_cloud_connector/">HELYX-OS Cloud Connector</a><button aria-label="Toggle the collapsible sidebar category &#x27;HELYX-OS Cloud Connector&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/tutorials/openfoam_on_parallel_works/">OpenFOAM On Parallel Works</a><button aria-label="Toggle the collapsible sidebar category &#x27;OpenFOAM On Parallel Works&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/tutorials/energyplus_sweep/">EnergyPlus Sweep</a><button aria-label="Toggle the collapsible sidebar category &#x27;EnergyPlus Sweep&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/tutorials/epa_swmm_sweep_tutorials/">EPA SWMM Sweep Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;EPA SWMM Sweep Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tutorials/using-gpu-nodes-on-gcp">Using GPU Nodes on GCP</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Using GPU Nodes on GCP</h1><p>This guide will walk you through creating a new cluster resource on the Parallel Works platform, and configuring it for use with attached GPU nodes running in Google Cloud</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="adding-a-new-resource"><strong>Adding a new resource</strong><a class="hash-link" href="#adding-a-new-resource" title="Direct link to heading">â€‹</a></h3><p>From the main PW page, click <code>Resources</code> on the top banner. This will take your resource management page. From there, push the <code>+ Add Resource</code> button, located near the top right of the window:</p><p>![](/gitbook/assets/Screen Shot 2022-01-21 at 12.28.18 PM.png&gt;)</p><p>Clicking the <code>+ Add Resource</code> button will navigate you to a simple web form that will prompt for basic information like resource name, a short description, and which CSP to use. You will also have the option to choose between <code>V1</code> and <code>V2</code> types. For now, let&#x27;s select <code>Google Slurm V1</code>. With the information provided, click <code>Add Resource</code>.<!-- --> </p><p>![](/gitbook/assets/Screen Shot 2022-01-21 at 1.30.45 PM.png&gt;)</p><p>After adding the resource, your browser should redirect you to the main configuration page for the cluster. Here you will need to configure the resource account, project, and other miscellaneous optional settings. To get a basic template of the Slurm configuration, you can click <code>restore configuration</code> and then edit the template your desired configuration:</p><p>![](/gitbook/assets/Screen Shot 2022-01-21 at 1.48.13 PM.png&gt;)</p><p>A sample Slurm configuration utilizing a single <code>a2-highgpu-8g</code> compute node is shown below. This configuration is ideal if you only intend to use the cluster for Slurm jobs, and don&#x27;t need to do anything computational on the controller itself. This example can be directly copy pasted into the <code>Slurm Configuration</code> text box in your own cluster:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">resources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- name: __NAME__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type: slurm.jinja</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  properties:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cluster_name            : __NAME__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zone                    : us-central1-c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vpc_net                   : default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vpc_subnet                : default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_machine_type : c2-standard-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_disk_size_gb   : 50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    external_controller_ip    : True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_secondary_disk         : True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_secondary_disk_type    : pd-ssd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_secondary_disk_size_gb : 200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    external_compute_ips      : False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    suspend_time              : 300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    partitions :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name              : compute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        machine_type      : a2-highgpu-8g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        machine_type_is_gpu: True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        max_node_count    : 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zone              : us-central1-c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        vpc_subnet                : default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Now that our cluster is configured, we can click <code>Save Resource</code>, located near the top of the page, and start it from the main <code>Compute</code> page by clicking the power button. The cluster should be accessible in a few minutes.</p><p>![](/gitbook/assets/Screen Shot 2022-01-21 at 1.54.38 PM.png&gt;)</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="accessing-the-cluster-and-gpu-node">Accessing the cluster and GPU node<a class="hash-link" href="#accessing-the-cluster-and-gpu-node" title="Direct link to heading">â€‹</a></h3><p>When the cluster is ready for use, login to the controller using the PW built-in IDE, or an ssh client of your choice (if configured). From there, you&#x27;re ready to submit jobs to the GPU node:</p><p>![](/gitbook/assets/Screen Shot 2022-01-21 at 2.06.38 PM.png&gt;)</p><p>![](/gitbook/assets/Screen Shot 2022-01-21 at 2.13.40 PM.png&gt;)</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="running-the-jupyterlab-workflow-on-a-gpu-node">Running the Jupyterlab workflow on a GPU node<a class="hash-link" href="#running-the-jupyterlab-workflow-on-a-gpu-node" title="Direct link to heading">â€‹</a></h3><p>If you want to run Jupyterlab on a GPU node, it is easiest to run it directly on the head node instead of as a Slurm job. For this exercise, start by creating a second resource named <code>gcluster_v1_jupyter_gpu</code> with the same basic settings as the first. Since the Jupyterlab workflow requires an ssh tunnel to connect to it, you will also need to fill in the <code>Access Public Key</code> box with a <strong>public</strong> ssh key from your local workstation:</p><p>![](/gitbook/assets/Screen Shot 2022-01-21 at 3.13.45 PM.png&gt;)</p><p> <!-- -->Next, add a Slurm configuration specifying a GPU node as the controller:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">resources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- name: __NAME__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type: slurm.jinja</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  properties:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cluster_name            : __NAME__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zone                    : us-central1-c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vpc_net                   : default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vpc_subnet                : default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_machine_type : a2-highgpu-8g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_machine_type_is_gpu: True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_disk_size_gb   : 50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    external_controller_ip    : True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_secondary_disk         : True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_secondary_disk_type    : pd-ssd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_secondary_disk_size_gb : 200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    external_compute_ips      : False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    suspend_time              : 300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    partitions :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name              : compute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        machine_type      : a2-highgpu-8g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        machine_type_is_gpu: True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        max_node_count    : 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zone              : us-central1-c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        vpc_subnet                : default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This configuration will allow you to access GPUs directly from the controller, and also submit jobs to a secondary GPU node in a Slurm cluster. <strong>To help minimize compute costs,</strong> <strong>This configuration should only be used if you intend to use the GPUs directly on the head node.</strong> If you only need access to GPUs on the batch nodes, you should select a smaller instance type for the controller, as shown in the first example of this guide.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/parallelworks/docs/tree/master/docs/tutorials/using-gpu-nodes-on-gcp.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/tutorials/epa_swmm_sweep_tutorials/view_results"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">View Results</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#adding-a-new-resource" class="table-of-contents__link toc-highlight"><strong>Adding a new resource</strong></a></li><li><a href="#accessing-the-cluster-and-gpu-node" class="table-of-contents__link toc-highlight">Accessing the cluster and GPU node</a></li><li><a href="#running-the-jupyterlab-workflow-on-a-gpu-node" class="table-of-contents__link toc-highlight">Running the Jupyterlab workflow on a GPU node</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Parallel Works, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.334342b3.js"></script>
<script src="/assets/js/main.8b38f249.js"></script>
</body>
</html>