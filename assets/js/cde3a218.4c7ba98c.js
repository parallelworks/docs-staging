"use strict";(self.webpackChunkpworks_docs=self.webpackChunkpworks_docs||[]).push([[829],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return g}});var c=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,c)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,c,s=function(e,t){if(null==e)return{};var n,c,s={},r=Object.keys(e);for(c=0;c<r.length;c++)n=r[c],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(c=0;c<r.length;c++)n=r[c],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var o=c.createContext({}),l=function(e){var t=c.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=l(e.components);return c.createElement(o.Provider,{value:t},e.children)},b="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return c.createElement(c.Fragment,{},t)}},m=c.forwardRef((function(e,t){var n=e.components,s=e.mdxType,r=e.originalType,o=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),b=l(n),m=s,g=b["".concat(o,".").concat(m)]||b[m]||p[m]||r;return n?c.createElement(g,a(a({ref:t},u),{},{components:n})):c.createElement(g,a({ref:t},u))}));function g(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=n.length,a=new Array(r);a[0]=m;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i[b]="string"==typeof e?e:s,a[1]=i;for(var l=2;l<r;l++)a[l]=n[l];return c.createElement.apply(null,a)}return c.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2969:function(e,t,n){var c=n(7294);t.Z=e=>{let{children:t,color:n}=e;return c.createElement("span",{style:{backgroundColor:n,borderRadius:"25px",color:"#fff",padding:".65rem"}},t)}},4204:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return i},default:function(){return p},frontMatter:function(){return a},metadata:function(){return o},toc:function(){return u}});var c=n(3117),s=(n(7294),n(3905)),r=n(2969);const a={sidebar_position:3},i="Preparing AWS",o={unversionedId:"managing-organizations/preparing-aws",id:"managing-organizations/preparing-aws",title:"Preparing AWS",description:"This page details how to set up an AWS account so it's ready for the PW platform to manage infrastructure, clusters, billing, storage, and usage data.",source:"@site/docs/managing-organizations/preparing-aws.md",sourceDirName:"managing-organizations",slug:"/managing-organizations/preparing-aws",permalink:"/managing-organizations/preparing-aws",draft:!1,editUrl:"https://github.com/parallelworks/docs/tree/master/docs/managing-organizations/preparing-aws.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"docsSidebar",previous:{title:"Getting Support",permalink:"/getting-support"}},l={},u=[{value:"AWS Account",id:"aws-account",level:2},{value:"Setting Up AWS Credentials",id:"setting-up-aws-credentials",level:2},{value:"Create an Access Key",id:"create-an-access-key",level:3},{value:"AWS Policies",id:"aws-policies",level:3},{value:'<Highlight color="#ff5800">pw-infra-clusters</Highlight>',id:"pw-infra-clusters",level:4},{value:'<Highlight color="#ff5800">pw-infra-create</Highlight>',id:"pw-infra-create",level:4},{value:'<Highlight color="#ff5800">pw-infra-delete</Highlight>',id:"pw-infra-delete",level:4},{value:'<Highlight color="#ff5800">pw-billing</Highlight>',id:"pw-billing",level:4}],b={toc:u};function p(e){let{components:t,...n}=e;return(0,s.kt)("wrapper",(0,c.Z)({},b,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"preparing-aws"},"Preparing AWS"),(0,s.kt)("p",null,"This page details how to set up an AWS account so it's ready for the PW platform to manage infrastructure, clusters, billing, storage, and usage data."),(0,s.kt)("admonition",{title:"Persona",type:"info"},(0,s.kt)("p",{parentName:"admonition"},"The steps included on this page should be completed by a ",(0,s.kt)("strong",{parentName:"p"},"cloud engineer")," in your organization.")),(0,s.kt)("h2",{id:"aws-account"},"AWS Account"),(0,s.kt)("p",null,"We recommend creating a new AWS account for the PW platform. This will allow you to keep your existing AWS account separate from the PW platform, and will make it easier to manage billing and usage data. This will ensure the principle of least priviledge, as the PW platform will only have access to the resources it needs to manage."),(0,s.kt)("p",null,"If you use AWS organizations, you can create a new account within your organization, by following ",(0,s.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_accounts_create.html"},"AWS documentation"),". Otherwise, follow ",(0,s.kt)("a",{parentName:"p",href:"https://aws.amazon.com/premiumsupport/knowledge-center/create-and-activate-aws-account/"},"the instructions")," for making a non-organization account."),(0,s.kt)("h2",{id:"setting-up-aws-credentials"},"Setting Up AWS Credentials"),(0,s.kt)("p",null,"To get started quickly, you can ",(0,s.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_create.html"},"create a new IAM User")," and assign the ",(0,s.kt)("inlineCode",{parentName:"p"},"AdministratorAccess")," AWS managed policy to it."),(0,s.kt)("p",null,"Alternatively, you can ",(0,s.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_create.html"},"create policies")," listed in ",(0,s.kt)("a",{parentName:"p",href:"#aws-policies"},(0,s.kt)("strong",{parentName:"a"},"AWS Policies"))," below, then attach those policies to the IAM user."),(0,s.kt)("h3",{id:"create-an-access-key"},"Create an Access Key"),(0,s.kt)("p",null,"The PW platform requires the use of an AWS access key to authenticate with AWS. You can create an access key by following the ",(0,s.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html"},"AWS documentation"),"."),(0,s.kt)("admonition",{title:"Security Best Practices",type:"info"},(0,s.kt)("p",{parentName:"admonition"},"The PW platform will immediately rotate the secret access key after it's entered into the system. The platform will then use the rotated secret access key to generate short term credentials which will be used by all PW platform services."),(0,s.kt)("p",{parentName:"admonition"},"For more information about AWS keys and security best practices, see ",(0,s.kt)("a",{parentName:"p",href:"https://aws.amazon.com/premiumsupport/knowledge-center/security-best-practices/"},"this FAQ on the AWS website"),".")),(0,s.kt)("h3",{id:"aws-policies"},"AWS Policies"),(0,s.kt)("p",null,"This section includes the policies you\u2019ll need to attach to the IAM user you create for the PW platform. You can create these policies in the IAM console, or you can use the JSON below to create them using the AWS CLI."),(0,s.kt)("h4",{id:"pw-infra-clusters"},(0,s.kt)(r.Z,{color:"#ff5800",mdxType:"Highlight"},"pw-infra-clusters")),(0,s.kt)("p",null,"This policy is used for creating clusters."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": [\n        "ec2:AuthorizeSecurityGroupIngress",\n        "ec2:DescribeInstances",\n        "ec2:CreateKeyPair",\n        "ec2:CreateImage",\n        "ec2:CopyImage",\n        "ec2:DescribeSnapshots",\n        "ec2:DescribePlacementGroups",\n        "ec2:DeleteVolume",\n        "ec2:ModifySnapshotAttribute",\n        "ec2:CreatePlacementGroup",\n        "ec2:DescribeVolumes",\n        "ec2:DescribeKeyPairs",\n        "ec2:DetachVolume",\n        "fsx:ListTagsForResource",\n        "ec2:ImportKeyPair",\n        "ec2:CreateTags",\n        "ec2:RegisterImage",\n        "ec2:ModifyNetworkInterfaceAttribute",\n        "route53:ChangeResourceRecordSets",\n        "ec2:DeleteNetworkInterface",\n        "fsx:UntagResource",\n        "ec2:RunInstances",\n        "ec2:StopInstances",\n        "ec2:CreateVolume",\n        "ec2:CreateNetworkInterface",\n        "ec2:GetPasswordData",\n        "ec2:DescribeImageAttribute",\n        "ec2:DescribeInstanceTypes",\n        "ec2:AssociateAddress",\n        "ec2:DescribeSubnets",\n        "ec2:DeleteKeyPair",\n        "ec2:AttachVolume",\n        "ec2:DisassociateAddress",\n        "fsx:DescribeFileSystems",\n        "ec2:DeregisterImage",\n        "ec2:DeleteSnapshot",\n        "ec2:DescribeInstanceAttribute",\n        "ec2:DescribeRegions",\n        "ec2:ModifyImageAttribute",\n        "iam:PassRole",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:CreateSecurityGroup",\n        "ec2:CreateSnapshot",\n        "ec2:ModifyInstanceAttribute",\n        "fsx:TagResource",\n        "ec2:DescribeInstanceStatus",\n        "ec2:TerminateInstances",\n        "ec2:DetachNetworkInterface",\n        "ec2:DeletePlacementGroup",\n        "ec2:DescribeTags",\n        "ec2:DescribeSecurityGroups",\n        "fsx:DeleteFileSystem",\n        "ec2:DescribeImages",\n        "ec2:DescribeVpcs",\n        "ec2:DeleteSecurityGroup",\n        "fsx:CreateFileSystem",\n        "ec2:AttachNetworkInterface"\n      ],\n      "Resource": "*"\n    }\n  ]\n}\n')),(0,s.kt)("h4",{id:"pw-infra-create"},(0,s.kt)(r.Z,{color:"#ff5800",mdxType:"Highlight"},"pw-infra-create")),(0,s.kt)("p",null,"This policy is used to create base infrastructure."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": [\n        "ec2:AssociateDhcpOptions",\n        "ec2:AssociateRouteTable",\n        "ec2:AttachInternetGateway",\n        "ec2:AuthorizeSecurityGroupEgress",\n        "ec2:AuthorizeSecurityGroupIngress",\n        "ec2:CreateDhcpOptions",\n        "ec2:CreateInternetGateway",\n        "ec2:CreateNatGateway",\n        "ec2:CreateRoute",\n        "ec2:CreateRouteTable",\n        "ec2:CreateSecurityGroup",\n        "ec2:CreateSubnet",\n        "ec2:CreateVpc",\n        "ec2:DescribeAccountAttributes",\n        "ec2:DescribeAddresses",\n        "ec2:DescribeAvailabilityZones",\n        "ec2:DescribeDhcpOptions",\n        "ec2:DescribeInternetGateways",\n        "ec2:DescribeNatGateways",\n        "ec2:DescribeNetworkAcls",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeSecurityGroups",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeVpcAttribute",\n        "ec2:DescribeVpcClassicLink",\n        "ec2:DescribeVpcClassicLinkDnsSupport",\n        "ec2:DescribeVpcs",\n        "ec2:ModifyVpcAttribute",\n        "ec2:RevokeSecurityGroupEgress",\n        "ec2:CreateTags",\n        "ec2:AllocateAddress",\n        "iam:AddRoleToInstanceProfile",\n        "iam:CreateAccessKey",\n        "iam:CreateInstanceProfile",\n        "iam:CreateRole",\n        "iam:CreateUser",\n        "iam:GetInstanceProfile",\n        "iam:GetRole",\n        "iam:GetRolePolicy",\n        "iam:GetUser",\n        "iam:ListAttachedRolePolicies",\n        "iam:ListRolePolicies",\n        "iam:PutRolePolicy",\n        "iam:PutUserPolicy",\n        "iam:TagRole",\n        "iam:TagUser",\n        "iam:PassRole",\n        "route53:ChangeTagsForResource",\n        "route53:CreateHostedZone",\n        "route53:GetChange",\n        "route53:GetHostedZone",\n        "route53:ListResourceRecordSets",\n        "route53:ListTagsForResource",\n        "sts:GetCallerIdentity"\n      ],\n      "Resource": "*"\n    }\n  ]\n}\n')),(0,s.kt)("h4",{id:"pw-infra-delete"},(0,s.kt)(r.Z,{color:"#ff5800",mdxType:"Highlight"},"pw-infra-delete")),(0,s.kt)("p",null,"This policy is used to delete base infrastructure."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": [\n        "sts:GetCallerIdentity",\n        "sts:GetCallerIdentity",\n        "ec2:DescribeAccountAttributes",\n        "ec2:DescribeAvailabilityZones",\n        "ec2:DescribeAddresses",\n        "ec2:DescribeVpcs",\n        "ec2:DeleteTags",\n        "iam:GetUser",\n        "iam:GetRole",\n        "iam:UntagRole",\n        "iam:UntagUser",\n        "ec2:DescribeVpcAttribute",\n        "iam:ListRolePolicies",\n        "iam:ListAccessKeys",\n        "iam:GetUserPolicy",\n        "ec2:DescribeVpcAttribute",\n        "iam:GetRolePolicy",\n        "iam:ListAttachedRolePolicies",\n        "ec2:DescribeVpcClassicLink",\n        "iam:GetInstanceProfile",\n        "iam:GetRolePolicy",\n        "ec2:DescribeVpcClassicLinkDnsSupport",\n        "iam:GetRole",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeNetworkAcls",\n        "ec2:DescribeSecurityGroups",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeSecurityGroups",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeInternetGateways",\n        "route53:GetHostedZone",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeSubnets",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeNatGateways",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "route53:ListResourceRecordSets",\n        "ec2:DescribeRouteTables",\n        "route53:ListTagsForResource",\n        "ec2:DescribeDhcpOptions",\n        "ec2:DescribeVpcs",\n        "sts:GetCallerIdentity",\n        "sts:GetCallerIdentity",\n        "ec2:DescribeAccountAttributes",\n        "ec2:DisassociateRouteTable",\n        "ec2:DisassociateRouteTable",\n        "iam:DeleteAccessKey",\n        "iam:DeleteUserPolicy",\n        "iam:RemoveRoleFromInstanceProfile",\n        "ec2:DisassociateRouteTable",\n        "ec2:DisassociateRouteTable",\n        "ec2:DisassociateRouteTable",\n        "ec2:AssociateDhcpOptions",\n        "ec2:DeleteRoute",\n        "iam:DeleteInstanceProfile",\n        "iam:DeleteRolePolicy",\n        "ec2:DisassociateRouteTable",\n        "ec2:DisassociateRouteTable",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DisassociateRouteTable",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DisassociateRouteTable",\n        "ec2:DisassociateRouteTable",\n        "ec2:DisassociateRouteTable",\n        "ec2:DisassociateRouteTable",\n        "ec2:DeleteRoute",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "iam:ListGroupsForUser",\n        "ec2:DeleteDhcpOptions",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "iam:DeleteUser",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeNetworkInterfaces",\n        "iam:ListInstanceProfilesForRole",\n        "ec2:DescribeRouteTables",\n        "ec2:DescribeRouteTables",\n        "iam:ListRolePolicies",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DescribeNetworkInterfaces",\n        "route53:ListResourceRecordSets",\n        "iam:DeleteRole",\n        "ec2:DeleteSubnet",\n        "ec2:DeleteSubnet",\n        "ec2:DeleteSubnet",\n        "ec2:DeleteSubnet",\n        "ec2:DeleteSecurityGroup",\n        "ec2:DeleteSubnet",\n        "ec2:DescribeRouteTables",\n        "ec2:DeleteNatGateway",\n        "ec2:DescribeRouteTables",\n        "ec2:DeleteSubnet",\n        "ec2:DeleteRouteTable",\n        "ec2:DescribeRouteTables",\n        "route53:GetDNSSEC",\n        "route53:DeleteHostedZone",\n        "ec2:DescribeNatGateways",\n        "ec2:DescribeNatGateways",\n        "ec2:DescribeNatGateways",\n        "ec2:DescribeNatGateways",\n        "ec2:DescribeNatGateways",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DescribeAddresses",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DescribeNetworkInterfaces",\n        "ec2:DeleteSubnet",\n        "ec2:DeleteSubnet",\n        "ec2:DeleteSubnet",\n        "ec2:DeleteSubnet",\n        "ec2:DeleteSubnet",\n        "ec2:DeleteSubnet",\n        "ec2:ReleaseAddress",\n        "ec2:DetachInternetGateway",\n        "ec2:DeleteInternetGateway",\n        "ec2:DeleteVpc"\n      ],\n      "Resource": "*"\n    }\n  ]\n}\n')),(0,s.kt)("h4",{id:"pw-billing"},(0,s.kt)(r.Z,{color:"#ff5800",mdxType:"Highlight"},"pw-billing")),(0,s.kt)("p",null,"This policy is used to access billing information."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": [\n        "s3:GetLifecycleConfiguration",\n        "s3:GetBucketTagging",\n        "s3:PutAccelerateConfiguration",\n        "s3:DeleteObjectVersion",\n        "s3:ListBucketVersions",\n        "s3:GetBucketLogging",\n        "s3:CreateBucket",\n        "s3:ListBucket",\n        "s3:GetAccelerateConfiguration",\n        "s3:GetBucketPolicy",\n        "s3:PutEncryptionConfiguration",\n        "s3:GetObjectAcl",\n        "s3:GetEncryptionConfiguration",\n        "s3:GetBucketObjectLockConfiguration",\n        "s3:PutBucketTagging",\n        "s3:GetBucketRequestPayment",\n        "s3:PutLifecycleConfiguration",\n        "s3:PutBucketAcl",\n        "cur:*",\n        "s3:DeleteObject",\n        "s3:DeleteBucket",\n        "s3:PutBucketVersioning",\n        "s3:PutObjectAcl",\n        "s3:GetBucketPolicyStatus",\n        "s3:GetBucketWebsite",\n        "s3:PutReplicationConfiguration",\n        "s3:GetBucketVersioning",\n        "s3:PutBucketCORS",\n        "s3:GetBucketAcl",\n        "s3:DeleteBucketPolicy",\n        "s3:GetReplicationConfiguration",\n        "s3:PutObject",\n        "s3:GetObject",\n        "s3:PutBucketWebsite",\n        "s3:ListAllMyBuckets",\n        "s3:PutBucketRequestPayment",\n        "s3:PutBucketLogging",\n        "s3:GetBucketCORS",\n        "s3:PutBucketPolicy",\n        "s3:PutBucketObjectLockConfiguration",\n        "s3:GetBucketLocation",\n        "s3:GetObjectVersion"\n      ],\n      "Resource": "*"\n    }\n  ]\n}\n')))}p.isMDXComponent=!0}}]);